<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ADD_VARIANT</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ADD_VARIANT</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Adicionar variante</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">***********************************************************************</font>
<font color ="#0000FF">*   Method attributes.           *</font>
<font color ="#0000FF">***********************************************************************</font>
Instantiation: Public
<font color ="#0000FF">***********************************************************************</font>

  METHOD add_variant.

<font color ="#0000FF">* DEFINITION SECTION -------------------------- //</font>

    DATA: lt_tvarvc TYPE STANDARD TABLE OF tvarvc,
          lt_where  TYPE STANDARD TABLE OF string.

    FIELD-SYMBOLS: &lt;ls_main&gt;   LIKE LINE OF t_main[],
                   &lt;ls_where&gt;  LIKE LINE OF lt_where,
                   &lt;ls_tvarvc&gt; LIKE LINE OF lt_tvarvc.

    DATA: lv_flag_variant_exists TYPE boolean.

<font color ="#0000FF">* LOGIC SECTION ------------------------------- //</font>

    "Preconditions
    IF im_name IS INITIAL.
      MESSAGE text-m01 TYPE 'E' RAISING inconsistent.
    ENDIF.

    IF me-&gt;t_main[] IS NOT INITIAL.
      LOOP AT me-&gt;t_main[] ASSIGNING &lt;ls_main&gt;.
        IF im_separator IS NOT INITIAL.
          IF &lt;ls_main&gt;-prefix = im_name.
            lv_flag_variant_exists = abap_true.
            EXIT.
          ENDIF.
        ELSE.
          IF &lt;ls_main&gt;-fullname = im_name.
            lv_flag_variant_exists = abap_true.
            EXIT.
          ENDIF.
        ENDIF.
      ENDLOOP.
      IF lv_flag_variant_exists = abap_true.
        RETURN.
      ENDIF.
    ENDIF.

    " Prepare conditions
    APPEND INITIAL LINE TO lt_where[] ASSIGNING &lt;ls_where&gt;.
    &lt;ls_where&gt; = me-&gt;_get_condition( im_variant_name      = im_name
                                     im_variant_separator = im_separator ).

    " Select values
    SELECT *
      FROM tvarvc
      INTO TABLE lt_tvarvc[]
      WHERE (lt_where).

    " Check results
    IF sy-subrc &lt;&gt; 0.
      MESSAGE text-m02 TYPE 'E' RAISING not_found.
    ENDIF.

    LOOP AT lt_tvarvc[] ASSIGNING &lt;ls_tvarvc&gt;.
      me-&gt;_append_values( im_variant_data      = &lt;ls_tvarvc&gt;
                          im_variant_separator = im_separator ).
    ENDLOOP.

  ENDMETHOD.                    "add_variant
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 731
</font>
</body>
</html>
